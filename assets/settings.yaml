# --- Pix2Tex Model Configuration (Hybrid Architecture) ---

# 基本構造
name: math_ocr_model
id: null
encoder_structure: hybrid
decoder_structure: transformer

# エンコーダー設定 (ResNet + Transformer)
backbone_layers: [2, 3, 7]
channels: 1
patch_size: 16
encoder_depth: 4
dim: 256
heads: 8
num_layers: 4
dropout: 0.1
emb_dropout: 0.1

# デコーダー設定
decoder_args:
  max_seq_len: 512
  dim: 256
  num_layers: 4
  heads: 8
  dropout: 0.1
  num_tokens: 8000   # 語彙サイズ（tokenizer.jsonがない場合の保険）
  ff_dim: 1024       # FeedForward層の次元

# これまでエラーになっていたルートレベルのパラメータ
num_tokens: 8000
max_seq_len: 512
pad_token: 0
bos_token: 1
eos_token: 2
unk_token: 3

# 画像サイズ制約 (int型で明示)
max_height: 192
max_width: 672
min_height: 32
min_width: 32

# 学習・推論パラメータ
temperature: 0.2
batchsize: 10
micro_batchsize: -1
optimizer: AdamW
scheduler: OneCycleLR
lr: 0.001
min_lr: 0.0001
weight_decay: 0.05
seed: 42
epochs: 10
wandb: false
device: cpu
gpu_devices: []
sample_freq: 2000
val_freq: 1
log_freq: 100
workers: 1
